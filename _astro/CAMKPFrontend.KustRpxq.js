import{d as k,r as C,w as B,o,c as l,a as e,t as i,F as g,b as E,n as w,e as u,f as P,g as q,p as G,h as W,i as A,v as S,j as V,k as J}from"./runtime-dom.esm-bundler.AmjkPiyJ.js";const R=(m,n)=>{const a=m.__vccOpts||m;for(const[t,_]of n)a[t]=_;return a},Y=k({__name:"ListCAMs",props:{automatCAMKPEndpoint:{default:"https://automat.renci.org/cam-kp"},camList:{},changeSelectedModel:{}},setup(m,{expose:n}){n();const a=m,t=C();B(t,f=>a.changeSelectedModel(f));const _={props:a,selectedModel:t};return Object.defineProperty(_,"__isScriptSetup",{enumerable:!1,value:!0}),_}}),z={class:"card my-2"},Q={class:"card-header"},X={class:"card-body"},Z={class:"list-group"},ee=["onClick"],te={key:0},se=["href"];function ne(m,n,a,t,_,f){return o(),l("div",z,[e("div",Q,[e("strong",null,"List of CAM Models ("+i(a.camList.length)+")",1)]),e("div",X,[e("ul",Z,[(o(!0),l(g,null,E(a.camList,s=>(o(),l("li",{key:s,class:w("list-group-item list- "+(s==t.selectedModel?"active":"")),onClick:b=>t.selectedModel=s},[u(i(s)+" ",1),t.selectedModel!=s?(o(),l("span",te,[u("("),e("a",{href:s,target:"cam"},"URL",8,se),u(")")])):P("",!0)],10,ee))),128))])])])}const oe=R(Y,[["render",ne]]),le=k({__name:"DisplayCAM",props:{automatCAMKPEndpoint:{default:"https://automat.renci.org/cam-kp"},selectedModel:{}},setup(m,{expose:n}){n();const a=m,t=C(!1),_=C([]),f=C([]),s=C({}),b=C({}),M=q(()=>[...new Set(f.value.map(r=>r[0]).sort())]),I=q(()=>[...new Set(f.value.map(r=>r[1]).sort())]);function T(r,p){return f.value.filter(v=>v[0]==r&&v[1]==p).map(v=>v[3]?`${v[2]} [${v[3]}]`:v[2]).sort()}B(()=>a.selectedModel,(r,p)=>{_.value=[],f.value=[],s.value={},b.value={},O(p).then(v=>{_.value=v,v.map(d=>{f.value.push([d[0].id,d[2].id,d[3],d[4]]),s.value[d[0].id]=d[0].name,s.value[d[2].id]=d[2].name,b.value[d[0].id]=d[0].description,b.value[d[2].id]=d[2].description})})});async function O(r){t.value=!0;const p=a.automatCAMKPEndpoint+"/cypher";let d=await(await fetch(p,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:`MATCH (s)-[p]-(o) WHERE '${r}' IN p.xref RETURN DISTINCT s, p, o, TYPE(p) AS pred_type, CASE
    WHEN startNode(p) = s THEN ''
    WHEN endNode(p) = s THEN 'reverse'
    ELSE ''
  END AS direction;`})})).json();t.value=!1;const N=d.results.flatMap(y=>y.data).map(y=>y.row);return console.log(N),N}const j={props:a,downloadInProgress:t,modelRows:_,spos:f,labels:s,descriptions:b,fromIds:M,toIds:I,getPredicates:T,getModelRows:O};return Object.defineProperty(j,"__isScriptSetup",{enumerable:!1,value:!0}),j}}),c=m=>(G("data-v-f17ac3eb"),m=m(),W(),m),ae={key:0,class:"card my-2"},ie=c(()=>e("div",{class:"card-header"}," Download in progress ... ",-1)),ce=[ie],re={key:1,class:"card"},de={class:"card-header"},ue=c(()=>e("strong",null,"Relationships in selected CAM:",-1)),_e=["href"],pe={class:"card-body"},he={class:"table-responsive"},me={class:"table table-bordered table-hover"},fe=c(()=>e("th",{scope:"col"},"From CURIE",-1)),be={scope:"col"},Ce=["title"],ve=c(()=>e("br",null,null,-1)),Me=c(()=>e("br",null,null,-1)),ge=c(()=>e("br",null,null,-1)),ye={key:2,class:"card"},Ee={class:"card-header"},Ae=c(()=>e("strong",null,"Edges in selected CAM:",-1)),Se=["href"],Pe={class:"card-body"},Ie={class:"table table-bordered mb-2"},Oe=c(()=>e("thead",null,[e("tr",null,[e("th",null,"Subject"),e("th",null,"Edge"),e("th",null,"Object")])],-1)),je=c(()=>e("br",null,null,-1)),Ne=c(()=>e("br",null,null,-1)),Ue=c(()=>e("em",null,"Description",-1)),ke=c(()=>e("br",null,null,-1)),Re=c(()=>e("em",null,"Information Content",-1)),Te=c(()=>e("br",null,null,-1)),$e=c(()=>e("em",null,"Equivalent identifiers",-1)),xe={key:0},Ke=c(()=>e("br",null,null,-1)),Le=["href"],Ve=c(()=>e("br",null,null,-1)),He=c(()=>e("br",null,null,-1)),De=c(()=>e("em",null,"Description",-1)),qe=c(()=>e("br",null,null,-1)),Be=c(()=>e("em",null,"Information Content",-1)),Fe=c(()=>e("br",null,null,-1)),we=c(()=>e("em",null,"Equivalent identifiers",-1));function Ge(m,n,a,t,_,f){return o(),l(g,null,[t.downloadInProgress?(o(),l("div",ae,ce)):P("",!0),t.downloadInProgress?P("",!0):(o(),l("div",re,[e("div",de,[ue,u(),e("a",{target:"cam",href:a.selectedModel},i(a.selectedModel),9,_e)]),e("div",pe,[e("div",he,[e("table",me,[e("thead",null,[e("tr",null,[fe,(o(!0),l(g,null,E(t.toIds,s=>(o(),l("th",be,[e("span",{title:t.descriptions[s]},i(s),9,Ce),ve,u(i(t.labels[s]),1)]))),256))])]),e("tbody",null,[(o(!0),l(g,null,E(t.fromIds,s=>(o(),l("tr",null,[e("td",null,[e("strong",null,i(s),1),u(" "+i(t.labels[s]),1),Me,u(i(t.descriptions[s]),1)]),(o(!0),l(g,null,E(t.toIds,b=>(o(),l("td",null,[(o(!0),l(g,null,E(t.getPredicates(s,b),M=>(o(),l("span",null,[u(i(M),1),ge]))),256))]))),256))]))),256))])])])])])),t.downloadInProgress?P("",!0):(o(),l("div",ye,[e("div",Ee,[Ae,u(),e("a",{target:"cam",href:a.selectedModel},i(a.selectedModel),9,Se)]),e("div",Pe,[e("table",Ie,[Oe,e("tbody",null,[(o(!0),l(g,null,E(t.modelRows,s=>(o(),l("tr",null,[e("td",null,[e("strong",null,i(s[0].id),1),u(" "+i(s[0].name),1),je,Ne,Ue,u(": "+i(s[0].description),1),ke,Re,u(": "+i(s[0].information_content),1),Te,$e,u(": "+i(s[0].equivalent_identifiers),1)]),e("td",null,[e("strong",null,[u(i(s[3]),1),s[4]?(o(),l("span",xe," ["+i(s[4])+"]",1)):P("",!0)]),Ke,u(" biolink:primary_knowledge_source: "+i(s[1]["biolink:primary_knowledge_source"])+" ",1),e("ul",null,[(o(!0),l(g,null,E(s[1].xref,b=>(o(),l("li",{key:b},[e("a",{href:b,target:"xref"},i(b),9,Le)]))),128))])]),e("td",null,[e("strong",null,i(s[2].id),1),u(" "+i(s[2].name),1),Ve,He,De,u(": "+i(s[2].description),1),qe,Be,u(": "+i(s[2].information_content),1),Fe,we,u(": "+i(s[2].equivalent_identifiers),1)])]))),256))])])])]))],64)}const We=R(le,[["render",Ge],["__scopeId","data-v-f17ac3eb"]]),Je=k({__name:"SearchCAMs",props:{automatCAMKPEndpoint:{default:"https://automat.renci.org/cam-kp"},changeCAMList:{}},setup(m,{expose:n}){n();const a=m,t=C(""),_=C(""),f=C(""),s=C(""),b=C(10),M=C([]),I=C(!1);async function T(){I.value=!0,M.value=[];try{const r=await O(t.value.split(/\s*,\s*/).filter(p=>p),_.value.split(/\s*,\s*/).filter(p=>p),s.value.split(/\s*,\s*/).filter(p=>p),f.value.split(/\s*,\s*/).filter(p=>p),b.value);console.log(`Got ${r.length} CAM models: `,r),a.changeCAMList(r)}catch(r){M.value=r.message.split(`
`)}I.value=!1}async function O(r=[],p=[],v=[],d=[],N=100){const y=[],$=[];if(r.length>0&&(p.length>0||d.length>0))throw new Error(`searchModels() cannot be called with both subjectOrObjectCURIEs (${r.length}) and either subjectCURIEs (${p.length}) or objectCURIEs (${d.length}).`);p&&y.push(...p.map(h=>`'${h}' IN s.equivalent_identifiers`)),d&&$.push(...d.map(h=>`'${h}' IN o.equivalent_identifiers`)),r&&y.push(...r.map(h=>`'${h}' IN s.equivalent_identifiers OR '${h}' IN o.equivalent_identifiers`));const x=[];v&&x.push(...v.map(h=>`TYPE(p) = '${h}'`));const U=[];y.length>0&&U.push(y.map(h=>`(${h})`).join(" OR ")),$.length>0&&U.push($.map(h=>`(${h})`).join(" OR ")),x.length>0&&U.push(x.map(h=>`(${h})`).join(" OR "));const H=U.join(" AND ");let K=`MATCH (s)-[p]-(o) RETURN DISTINCT p.xref LIMIT ${N}`;H.length>0&&(K=`MATCH (s)-[p]-(o) WHERE ${H} RETURN DISTINCT p.xref LIMIT ${N}`),console.log("Querying Cypher:",K);const F=a.automatCAMKPEndpoint+"/cypher";let L=await(await fetch(F,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:K})})).json();if(L.errors.length>0)throw Error(L.errors.map(h=>h.message).join(`
`));const D=L.results[0].data.flatMap(h=>h.row[0][0]);return console.log("rows",D),D}const j={props:a,subjectOrObjectCURIEsCSV:t,subjectCURIEsCSV:_,objectCURIEsCSV:f,predicateCURIEsCSV:s,limit:b,errors:M,inProgress:I,updateModelList:T,searchModels:O};return Object.defineProperty(j,"__isScriptSetup",{enumerable:!1,value:!0}),j}}),Ye={class:"card my-2"},ze=e("div",{class:"card-header"},[e("strong",null,"Search CAM models")],-1),Qe={class:"card-body"},Xe={key:0,class:"mb-3 p-1 border-1 bg-danger-subtle"},Ze={class:"mb-3"},et=e("label",{for:"predicateCURIEs",class:"form-label"},"Predicate CURIEs",-1),tt={class:"mb-3"},st=e("label",{for:"subjectOrObjectCURIEs",class:"form-label"},"Subject or Object CURIEs",-1),nt={class:"mb-3"},ot=e("label",{for:"subjectCURIEs",class:"form-label"},"Subject CURIEs",-1),lt={class:"mb-3"},at=e("label",{for:"objectCURIEs",class:"form-label"},"Object CURIEs",-1),it={class:"mb-3"},ct=e("label",{for:"limit",class:"form-label"},"Limit",-1),rt=e("em",null,"Search in progress",-1),dt=[rt];function ut(m,n,a,t,_,f){return o(),l("div",Ye,[ze,e("div",Qe,[t.errors.length>0?(o(),l("div",Xe,[e("ul",null,[(o(!0),l(g,null,E(t.errors,s=>(o(),l("li",null,i(s),1))),256))])])):P("",!0),e("div",Ze,[et,A(e("input",{type:"text",class:"form-control",id:"predicateCURIEs",placeholder:"biolink:affects, biolink:affected_by","onUpdate:modelValue":n[0]||(n[0]=s=>t.predicateCURIEsCSV=s)},null,512),[[S,t.predicateCURIEsCSV]])]),e("div",tt,[st,A(e("input",{type:"text",class:"form-control",id:"subjectOrObjectCURIEs",placeholder:"PUBCHEM.COMPOUND:5865, CHEBI:8382","onUpdate:modelValue":n[1]||(n[1]=s=>t.subjectOrObjectCURIEsCSV=s)},null,512),[[S,t.subjectOrObjectCURIEsCSV]])]),e("div",nt,[ot,A(e("input",{type:"text",class:"form-control",id:"subjectCURIEs",placeholder:"CHEMBL.COMPOUND:CHEMBL158, PUBCHEM.COMPOUND:5742832","onUpdate:modelValue":n[2]||(n[2]=s=>t.subjectCURIEsCSV=s)},null,512),[[S,t.subjectCURIEsCSV]])]),e("div",lt,[at,A(e("input",{type:"text",class:"form-control",id:"objectCURIEs",placeholder:"CHEMBL.COMPOUND:CHEMBL158, PUBCHEM.COMPOUND:5742832","onUpdate:modelValue":n[3]||(n[3]=s=>t.objectCURIEsCSV=s)},null,512),[[S,t.objectCURIEsCSV]])]),e("div",it,[ct,A(e("input",{type:"text",class:"form-control",id:"limit","onUpdate:modelValue":n[4]||(n[4]=s=>t.limit=s)},null,512),[[S,t.limit]])]),t.inProgress?(o(),l("a",{key:1,onClick:n[5]||(n[5]=s=>t.updateModelList()),class:"btn btn-primary"},dt)):(o(),l("a",{key:2,onClick:n[6]||(n[6]=s=>t.updateModelList()),class:"btn btn-primary"},"Search"))])])}const _t=R(Je,[["render",ut]]),pt=k({__name:"CAMKPFrontend",setup(m,{expose:n}){n();const a=C("https://automat.renci.org/cam-kp"),t=C([]),_=C("");function f(M){_.value=M}function s(M){t.value=M}const b={automatCAMKPEndpoint:a,camList:t,selectedModel:_,changeSelectedModel:f,changeCAMList:s,ListCAMs:oe,DisplayCAM:We,SearchCAMs:_t};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}}),ht=J('<div class="card my-2"><div class="card-header"><strong>CAM-KP Frontend</strong></div><div class="card-body"><p class="card-text"> The CAM-KP Frontend is intended to provide a frontend to the <a href="https://github.com/NCATSTranslator/Translator-All/wiki/CAM-Provider-KG">Causal Activity Models (CAM) Knowledge Graph (KG)</a>, as implemented in <a href="https://automat.renci.org/#/cam-kp">Automat CAM-KP</a>. </p><p class="card-text"><strong>Experimental and under development.</strong> Please report any issues to <a href="https://github.com/ExposuresProvider/cam-pipeline/issues">our GitHub repository</a>. </p></div></div>',1),mt={class:"accordion",id:"advancedOptionsAccordion"},ft={class:"accordion-item"},bt=e("h2",{class:"accordion-header",id:"advancedOptionsHeader"},[e("button",{class:"accordion-button collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#advancedOptions","aria-expanded":"false","aria-controls":"advancedOptions"}," Advanced options ")],-1),Ct={id:"advancedOptions",class:"accordion-collapse collapse","aria-labelledby":"advancedOptionsHeader","data-bs-parent":"#advancedOptionsAccordion"},vt={class:"accordion-body"},Mt={class:"mb-3"},gt=e("label",{for:"automatCAMKPEndpoint",class:"form-label"},"Automat CAM-KP Endpoint",-1);function yt(m,n,a,t,_,f){return o(),l("main",null,[ht,V(t.SearchCAMs,{automatCAMKPEndpoint:t.automatCAMKPEndpoint,changeCAMList:t.changeCAMList},null,8,["automatCAMKPEndpoint"]),V(t.ListCAMs,{automatCAMKPEndpoint:t.automatCAMKPEndpoint,camList:t.camList,changeSelectedModel:t.changeSelectedModel},null,8,["automatCAMKPEndpoint","camList"]),V(t.DisplayCAM,{"selected-model":t.selectedModel},null,8,["selected-model"]),e("div",mt,[e("div",ft,[bt,e("div",Ct,[e("div",vt,[e("form",null,[e("div",Mt,[gt,A(e("input",{type:"email",class:"form-control",id:"automatCAMKPEndpoint","aria-describedby":"emailHelp","onUpdate:modelValue":n[0]||(n[0]=s=>t.automatCAMKPEndpoint=s)},null,512),[[S,t.automatCAMKPEndpoint]])])])])])])])])}const St=R(pt,[["render",yt]]);export{St as default};

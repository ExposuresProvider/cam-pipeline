import{d as q,c as L,r as b,w as J,o as n,a as l,b as e,e as I,f as d,t as o,F as E,g as j,n as A,p as z,h as Q,i as P,v as R,j as G,k as X}from"./runtime-dom.esm-bundler.NfPSTE8u.js";function W(h){const a=h.toLowerCase();return a.startsWith("http://ctdbase.org/detail.go?type=relationship&ixnid=")?"CTD.RELATIONSHIP:"+h.substring(53):a.startsWith("http://model.geneontology.org/")?"GO.MODEL:"+h.substring(30):h}const B=(h,a)=>{const c=h.__vccOpts||h;for(const[s,f]of a)c[s]=f;return c},Z=q({__name:"DisplayCAM",props:{automatCAMKPEndpoint:{default:"https://automat.renci.org/cam-kp"},selectedModel:{},searchIds:{}},setup(h,{expose:a}){a();const c=h,s=L(()=>!("url"in c.selectedModel)),f=b(!1),C=b([]),t=b([]),_=b({}),v=b({}),k=L(()=>[...new Set(t.value.map(M=>M[0]).sort())]),O=L(()=>[...new Set(t.value.map(M=>M[1]).sort())]);function N(M,g){return t.value.filter(p=>p[0]==M&&p[1]==g).map(p=>p[3]?`${p[2]} [${p[3]}]`:p[2]).sort()}J(()=>c.selectedModel,(M,g)=>{const p=g.url;C.value=[],t.value=[],_.value={},v.value={},x(p).then(y=>{C.value=y,y.map(u=>{t.value.push([u[0].id,u[2].id,u[3],u[4]]),_.value[u[0].id]=u[0].name,_.value[u[2].id]=u[2].name,v.value[u[0].id]=u[0].description,v.value[u[2].id]=u[2].description})})});async function x(M){f.value=!0;const g=c.automatCAMKPEndpoint+"/cypher";let y=await(await fetch(g,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:`MATCH (s)-[p]-(o) WHERE '${M}' IN p.xref RETURN DISTINCT s, p, o, TYPE(p) AS pred_type, CASE
    WHEN startNode(p) = s THEN ''
    WHEN endNode(p) = s THEN 'reverse'
    ELSE ''
  END AS direction;`})})).json();f.value=!1;const u=y.results.flatMap(S=>S.data).map(S=>S.row);return console.log(u),u}const U={props:c,modelNotSelected:s,downloadInProgress:f,modelRows:C,spos:t,labels:_,descriptions:v,fromIds:k,toIds:O,getPredicates:N,getModelRows:x,get urlToID(){return W}};return Object.defineProperty(U,"__isScriptSetup",{enumerable:!1,value:!0}),U}}),i=h=>(z("data-v-9109b779"),h=h(),Q(),h),ee={class:"col-6"},te={key:0,class:"card my-2"},se=i(()=>e("div",{class:"card-header"}," No model selected. Please search for one using the controls on the left. ",-1)),oe=[se],ne={key:1,class:"card my-2"},le={class:"card-header"},ae=["href"],ce={key:2,id:"edges",class:"card my-2"},de={class:"card-header"},ie=i(()=>e("strong",null,"Edges in selected CAM:",-1)),re=["href"],ue=i(()=>e("a",{href:"#relationships"},"Relationships",-1)),_e={class:"card-body"},he={class:"table table-bordered mb-2"},pe=i(()=>e("thead",null,[e("tr",null,[e("th",null,"Subject"),e("th",null,"Edge"),e("th",null,"Object")])],-1)),me=i(()=>e("br",null,null,-1)),be=i(()=>e("br",null,null,-1)),fe=i(()=>e("em",null,"Description",-1)),ve=i(()=>e("br",null,null,-1)),ge=i(()=>e("em",null,"Information Content",-1)),Ce=i(()=>e("br",null,null,-1)),Me=i(()=>e("em",null,"Equivalent identifiers",-1)),ye={key:0},Ee=i(()=>e("br",null,null,-1)),Ie={class:"overflow-auto",style:{height:"20em"}},Se=["href"],je=i(()=>e("br",null,null,-1)),Ae=i(()=>e("br",null,null,-1)),Pe=i(()=>e("em",null,"Description",-1)),Re=i(()=>e("br",null,null,-1)),Oe=i(()=>e("em",null,"Information Content",-1)),Ne=i(()=>e("br",null,null,-1)),Ue=i(()=>e("em",null,"Equivalent identifiers",-1)),Te={class:"col-12"},ke={key:0,id:"relationships",class:"card my-2"},xe={class:"card-header"},De=i(()=>e("strong",null,"Relationships in selected CAM:",-1)),Ve=["href"],He=i(()=>e("a",{href:"#edges"},"Edges",-1)),Ke={class:"card-body"},$e={class:"table-responsive"},Le={class:"table table-bordered table-hover"},qe=i(()=>e("th",{scope:"col"},"From CURIE",-1)),Be=["title"],we=i(()=>e("br",null,null,-1)),Fe=i(()=>e("br",null,null,-1)),Ge=i(()=>e("br",null,null,-1));function We(h,a,c,s,f,C){return n(),l(E,null,[e("div",ee,[s.modelNotSelected?(n(),l("div",te,oe)):I("",!0),s.downloadInProgress?(n(),l("div",ne,[e("div",le,[d(" Download of CAM "),e("a",{target:"cam",href:c.selectedModel.url},o(c.selectedModel.url),9,ae),d(" in progress ... ")])])):I("",!0),!s.downloadInProgress&&!s.modelNotSelected?(n(),l("div",ce,[e("div",de,[ie,d(),e("a",{target:"cam",href:c.selectedModel.url},o(c.selectedModel.url),9,re),d(" ("),ue,d(") ")]),e("div",_e,[e("table",he,[pe,e("tbody",null,[(n(!0),l(E,null,j(s.modelRows,t=>(n(),l("tr",null,[e("td",{class:A(t[0].equivalent_identifiers.some(_=>c.searchIds.has(_))?"bg-success-subtle":"")},[e("strong",null,o(t[0].id),1),d(" "+o(t[0].name),1),me,be,fe,d(": "+o(t[0].description),1),ve,ge,d(": "+o(t[0].information_content),1),Ce,Me,d(": "+o(t[0].equivalent_identifiers),1)],2),e("td",null,[e("strong",null,[d(o(t[3]),1),t[4]?(n(),l("span",ye," ["+o(t[4])+"]",1)):I("",!0)]),Ee,d(" biolink:primary_knowledge_source: "+o(t[1]["biolink:primary_knowledge_source"])+" ",1),e("ul",Ie,[(n(!0),l(E,null,j(t[1].xref,_=>(n(),l("li",{key:_},[e("a",{href:_,target:"xref"},o(s.urlToID(_)),9,Se)]))),128))])]),e("td",{class:A(t[2].equivalent_identifiers.some(_=>c.searchIds.has(_))?"bg-success-subtle":"")},[e("strong",null,o(t[2].id),1),d(" "+o(t[2].name),1),je,Ae,Pe,d(": "+o(t[2].description),1),Re,Oe,d(": "+o(t[2].information_content),1),Ne,Ue,d(": "+o(t[2].equivalent_identifiers),1)],2)]))),256))])])])])):I("",!0)]),e("div",Te,[!s.downloadInProgress&&!s.modelNotSelected?(n(),l("div",ke,[e("div",xe,[De,d(),e("a",{target:"cam",href:c.selectedModel.url},o(c.selectedModel.url),9,Ve),d(" ("),He,d(") ")]),e("div",Ke,[e("div",$e,[e("table",Le,[e("thead",null,[e("tr",null,[qe,(n(!0),l(E,null,j(s.toIds,t=>(n(),l("th",{scope:"col",class:A(c.searchIds.has(t)?"bg-success-subtle":"")},[e("span",{title:s.descriptions[t]},o(t),9,Be),we,d(o(s.labels[t]),1)],2))),256))])]),e("tbody",null,[(n(!0),l(E,null,j(s.fromIds,t=>(n(),l("tr",null,[e("td",{class:A(c.searchIds.has(t)?"bg-success-subtle":"")},[e("strong",null,o(t),1),d(" "+o(s.labels[t]),1),Fe,d(o(s.descriptions[t]),1)],2),(n(!0),l(E,null,j(s.toIds,_=>(n(),l("td",{class:A(c.searchIds.has(_)||c.searchIds.has(t)?"bg-success-subtle":"")},[(n(!0),l(E,null,j(s.getPredicates(t,_),v=>(n(),l("span",null,[d(o(v),1),Ge]))),256))],2))),256))]))),256))])])])])])):I("",!0)])],64)}const Ye=B(Z,[["render",We],["__scopeId","data-v-9109b779"]]),Je=q({__name:"SearchCAMs",props:{automatCAMKPEndpoint:{default:"https://automat.renci.org/cam-kp"},changeSelectedModel:{},changeSearchIds:{}},setup(h,{expose:a}){a();const c=h,s=b({}),f=b([]),C=b(""),t=b(""),_=b(""),v=b(""),k=b(100),O=b([]),N=b(!1);async function x(){N.value=!0,O.value=[];const g=C.value.split(/\s*,\s*/).filter(m=>m),p=t.value.split(/\s*,\s*/).filter(m=>m),y=v.value.split(/\s*,\s*/).filter(m=>m),u=_.value.split(/\s*,\s*/).filter(m=>m),S=new Set([...g,...p,...y,...u]);c.changeSearchIds(S);try{const m=await U(g,p,y,u,k.value);console.log(`Got ${m.length} CAM models: `,m),f.value=m}catch(m){O.value=m.message.split(`
`)}N.value=!1}async function U(g=[],p=[],y=[],u=[],S=100){const m=[],D=[],V=[];if(g.length>0&&(p.length>0||u.length>0))throw new Error(`searchModels() cannot be called with both subjectOrObjectCURIEs (${g.length}) and either subjectCURIEs (${p.length}) or objectCURIEs (${u.length}).`);p&&m.push(...p.map(r=>`'${r}' IN s.equivalent_identifiers`)),u&&D.push(...u.map(r=>`'${r}' IN o.equivalent_identifiers`)),g&&V.push(...g.map(r=>`'${r}' IN s.equivalent_identifiers OR '${r}' IN o.equivalent_identifiers`));const H=[];y&&H.push(...y.map(r=>`TYPE(p) = '${r}'`));const T=[];m.length>0&&T.push(m.map(r=>`(${r})`).join(" OR ")),D.length>0&&T.push(D.map(r=>`(${r})`).join(" OR ")),H.length>0&&T.push(H.map(r=>`(${r})`).join(" OR ")),V.length>0&&T.push(V.map(r=>`(${r})`).join(" AND "));const w=T.join(" AND ");let K=`MATCH (s)-[p]-(o) RETURN DISTINCT p.xref LIMIT ${S}`;w.length>0&&(K=`MATCH (s)-[p]-(o) WHERE ${w} RETURN DISTINCT p.xref, s, o, TYPE(p) AS pred_type LIMIT ${S}`),console.log("Querying Cypher:",K);const Y=c.automatCAMKPEndpoint+"/cypher";let $=await(await fetch(Y,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:K})})).json();if($.errors.length>0)throw Error($.errors.map(r=>r.message).join(`
`));const F=$.results[0].data.flatMap(r=>({id:W(r.row[0][0]),url:r.row[0][0],subj:r.row[1],obj:r.row[2],predicate:r.row[3]}));return console.log("rows",F),F}const M={props:c,selectedModel:s,results:f,subjectOrObjectCURIEsCSV:C,subjectCURIEsCSV:t,objectCURIEsCSV:_,predicateCURIEsCSV:v,limit:k,errors:O,inProgress:N,updateModelList:x,searchModels:U};return Object.defineProperty(M,"__isScriptSetup",{enumerable:!1,value:!0}),M}}),ze={class:"col-6"},Qe={class:"card my-2"},Xe=e("div",{class:"card-header"},[e("strong",null,"Search CAM models")],-1),Ze={class:"card-body"},et={key:0,class:"mb-3 p-1 border-1 bg-danger-subtle"},tt={class:"mb-3"},st=e("label",{for:"predicateCURIEs",class:"form-label"},"Predicate CURIEs",-1),ot={class:"mb-3"},nt=e("label",{for:"subjectOrObjectCURIEs",class:"form-label"},"Subject or Object CURIEs (items will be ANDed)",-1),lt={class:"mb-3"},at=e("label",{for:"subjectCURIEs",class:"form-label"},"Subject CURIEs",-1),ct={class:"mb-3"},dt=e("label",{for:"objectCURIEs",class:"form-label"},"Object CURIEs",-1),it={class:"mb-3"},rt=e("label",{for:"limit",class:"form-label"},"Limit",-1),ut=e("em",null,"Search in progress",-1),_t=[ut],ht={class:"card my-2"},pt={class:"card-header"},mt={class:"card-body"},bt={class:"table table-bordered mb-2"},ft=e("thead",null,[e("tr",null,[e("th",null,"Models")])],-1),vt=["onClick"],gt=["href"],Ct=e("a",{href:"#edges"},"Relationships",-1),Mt=e("a",{href:"#relationships"},"Relationships",-1),yt={key:0},Et={key:0},It={key:1};function St(h,a,c,s,f,C){return n(),l("div",ze,[e("div",Qe,[Xe,e("div",Ze,[s.errors.length>0?(n(),l("div",et,[e("ul",null,[(n(!0),l(E,null,j(s.errors,t=>(n(),l("li",null,o(t),1))),256))])])):I("",!0),e("div",tt,[st,P(e("input",{type:"text",class:"form-control",id:"predicateCURIEs",placeholder:"biolink:affects, biolink:affected_by","onUpdate:modelValue":a[0]||(a[0]=t=>s.predicateCURIEsCSV=t)},null,512),[[R,s.predicateCURIEsCSV]])]),e("div",ot,[nt,P(e("input",{type:"text",class:"form-control",id:"subjectOrObjectCURIEs",placeholder:"PUBCHEM.COMPOUND:5865, NCBIGene:2944","onUpdate:modelValue":a[1]||(a[1]=t=>s.subjectOrObjectCURIEsCSV=t)},null,512),[[R,s.subjectOrObjectCURIEsCSV]])]),e("div",lt,[at,P(e("input",{type:"text",class:"form-control",id:"subjectCURIEs",placeholder:"CHEMBL.COMPOUND:CHEMBL158, PUBCHEM.COMPOUND:5742832","onUpdate:modelValue":a[2]||(a[2]=t=>s.subjectCURIEsCSV=t)},null,512),[[R,s.subjectCURIEsCSV]])]),e("div",ct,[dt,P(e("input",{type:"text",class:"form-control",id:"objectCURIEs",placeholder:"CHEMBL.COMPOUND:CHEMBL158, PUBCHEM.COMPOUND:5742832","onUpdate:modelValue":a[3]||(a[3]=t=>s.objectCURIEsCSV=t)},null,512),[[R,s.objectCURIEsCSV]])]),e("div",it,[rt,P(e("input",{type:"text",class:"form-control",id:"limit","onUpdate:modelValue":a[4]||(a[4]=t=>s.limit=t)},null,512),[[R,s.limit]])]),s.inProgress?(n(),l("a",{key:1,onClick:a[5]||(a[5]=t=>s.updateModelList()),class:"btn btn-primary"},_t)):(n(),l("a",{key:2,onClick:a[6]||(a[6]=t=>s.updateModelList()),class:"btn btn-primary"},"Search"))])]),e("div",ht,[e("div",pt,[e("strong",null,"Search results ("+o(s.results.length)+")",1)]),e("div",mt,[e("table",bt,[ft,e("tbody",null,[(n(!0),l(E,null,j(s.results,t=>(n(),l("tr",{onClick:_=>{s.selectedModel=t,c.changeSelectedModel(t)},class:A(s.selectedModel.url==t.url?"table-active":"")},[e("td",null,[d(o(t.id)+" (",1),e("a",{href:t.url,target:"model-url"},"URL",8,gt),d(", "),Ct,d(", "),Mt,d(") "),t.subj||t.predicate||t.obj?(n(),l("ul",yt,[t.subj?(n(),l("li",Et,o(t.subj.id)+' ("'+o(t.subj.name)+'")',1)):I("",!0),e("li",null,o(t.predicate),1),t.obj?(n(),l("li",It,o(t.obj.id)+' ("'+o(t.obj.name)+'")',1)):I("",!0)])):I("",!0)])],10,vt))),256))])])])])])}const jt=B(Je,[["render",St]]),At=q({__name:"CAMKPFrontend",setup(h,{expose:a}){a();const c=b("https://automat.renci.org/cam-kp"),s=b({}),f=b([]);function C(v){s.value=v}function t(v){f.value=v}const _={automatCAMKPEndpoint:c,selectedModel:s,searchIds:f,changeSelectedModel:C,changeSearchIds:t,DisplayCAM:Ye,SearchCAMs:jt};return Object.defineProperty(_,"__isScriptSetup",{enumerable:!1,value:!0}),_}}),Pt=X('<div class="card my-2"><div class="card-header"><strong>CAM-KP Frontend</strong></div><div class="card-body"><p class="card-text"> The CAM-KP Frontend is intended to provide a frontend to the <a href="https://github.com/NCATSTranslator/Translator-All/wiki/CAM-Provider-KG">Causal Activity Models (CAM) Knowledge Graph (KG)</a>, as implemented in <a href="https://automat.renci.org/#/cam-kp">Automat CAM-KP</a>. </p><p class="card-text"><strong>Experimental and under development.</strong> Please report any issues to <a href="https://github.com/ExposuresProvider/cam-pipeline/issues">our GitHub repository</a>. </p></div></div>',1),Rt={class:"row"},Ot={class:"accordion",id:"advancedOptionsAccordion"},Nt={class:"accordion-item"},Ut=e("h2",{class:"accordion-header",id:"advancedOptionsHeader"},[e("button",{class:"accordion-button collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#advancedOptions","aria-expanded":"false","aria-controls":"advancedOptions"}," Advanced options ")],-1),Tt={id:"advancedOptions",class:"accordion-collapse collapse","aria-labelledby":"advancedOptionsHeader","data-bs-parent":"#advancedOptionsAccordion"},kt={class:"accordion-body"},xt={class:"mb-3"},Dt=e("label",{for:"automatCAMKPEndpoint",class:"form-label"},"Automat CAM-KP Endpoint",-1);function Vt(h,a,c,s,f,C){return n(),l("main",null,[Pt,e("div",Rt,[G(s.SearchCAMs,{automatCAMKPEndpoint:s.automatCAMKPEndpoint,changeSelectedModel:s.changeSelectedModel,changeSearchIds:s.changeSearchIds},null,8,["automatCAMKPEndpoint"]),G(s.DisplayCAM,{"selected-model":s.selectedModel,"search-ids":s.searchIds},null,8,["selected-model","search-ids"])]),e("div",Ot,[e("div",Nt,[Ut,e("div",Tt,[e("div",kt,[e("form",null,[e("div",xt,[Dt,P(e("input",{type:"email",class:"form-control",id:"automatCAMKPEndpoint","aria-describedby":"emailHelp","onUpdate:modelValue":a[0]||(a[0]=t=>s.automatCAMKPEndpoint=t)},null,512),[[R,s.automatCAMKPEndpoint]])])])])])])])])}const $t=B(At,[["render",Vt]]);export{$t as default};

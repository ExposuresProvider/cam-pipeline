import{d as $,r as C,w as F,o as n,c as o,a as e,t as a,F as g,b as y,n as G,e as r,f as I,g as B,p as W,h as J,i as S,v as P,j as H,k as Y}from"./runtime-dom.esm-bundler.AmjkPiyJ.js";const T=(p,l)=>{const i=p.__vccOpts||p;for(const[t,u]of l)i[t]=u;return i},z=$({__name:"ListCAMs",props:{automatCAMKPEndpoint:{default:"https://automat.renci.org/cam-kp"},camList:{},changeSelectedModel:{}},setup(p,{expose:l}){l();const i=p,t=C();F(t,h=>i.changeSelectedModel(h));const u={props:i,selectedModel:t};return Object.defineProperty(u,"__isScriptSetup",{enumerable:!1,value:!0}),u}}),Q={class:"card my-2"},X={class:"card-header"},Z={class:"card-body"},ee={class:"list-group"},te=["onClick"],se={key:0},ne=["href"];function oe(p,l,i,t,u,h){return n(),o("div",Q,[e("div",X,[e("strong",null,"List of CAM Models ("+a(i.camList.length)+")",1)]),e("div",Z,[e("ul",ee,[(n(!0),o(g,null,y(i.camList,s=>(n(),o("li",{key:s,class:G("list-group-item list- "+(s==t.selectedModel?"active":"")),onClick:m=>t.selectedModel=s},[r(a(s)+" ",1),t.selectedModel!=s?(n(),o("span",se,[r("("),e("a",{href:s,target:"cam"},"URL",8,ne),r(")")])):I("",!0)],10,te))),128))])])])}const le=T(z,[["render",oe]]),ae=$({__name:"DisplayCAM",props:{automatCAMKPEndpoint:{default:"https://automat.renci.org/cam-kp"},selectedModel:{}},setup(p,{expose:l}){l();const i=p,t=C(!1),u=C([]),h=C([]),s=C({}),m=C({}),M=B(()=>[...new Set(h.value.map(v=>v[0]).sort())]),O=B(()=>[...new Set(h.value.map(v=>v[1]).sort())]);function j(v,b){return h.value.filter(c=>c[0]==v&&c[1]==b).map(c=>c[3]?`${c[2]} [${c[3]}]`:c[2]).sort()}F(()=>i.selectedModel,(v,b)=>{u.value=[],h.value=[],s.value={},m.value={},U(b).then(c=>{u.value=c,c.map(f=>{h.value.push([f[0].id,f[2].id,f[3],f[4]]),s.value[f[0].id]=f[0].name,s.value[f[2].id]=f[2].name,m.value[f[0].id]=f[0].description,m.value[f[2].id]=f[2].description})})});async function U(v){t.value=!0;const b=i.automatCAMKPEndpoint+"/cypher";let f=await(await fetch(b,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:`MATCH (s)-[p]-(o) WHERE '${v}' IN p.xref RETURN DISTINCT s, p, o, TYPE(p) AS pred_type, CASE
    WHEN startNode(p) = s THEN ''
    WHEN endNode(p) = s THEN 'reverse'
    ELSE ''
  END AS direction;`})})).json();t.value=!1;const E=f.results.flatMap(A=>A.data).map(A=>A.row);return console.log(E),E}const N={props:i,downloadInProgress:t,modelRows:u,spos:h,labels:s,descriptions:m,fromIds:M,toIds:O,getPredicates:j,getModelRows:U};return Object.defineProperty(N,"__isScriptSetup",{enumerable:!1,value:!0}),N}}),d=p=>(W("data-v-f17ac3eb"),p=p(),J(),p),ie={key:0,class:"card my-2"},ce=d(()=>e("div",{class:"card-header"}," Download in progress ... ",-1)),de=[ce],re={key:1,class:"card"},ue={class:"card-header"},_e=d(()=>e("strong",null,"Relationships in selected CAM:",-1)),pe=["href"],he={class:"card-body"},me={class:"table-responsive"},be={class:"table table-bordered table-hover"},fe=d(()=>e("th",{scope:"col"},"From CURIE",-1)),Ce={scope:"col"},ve=["title"],Me=d(()=>e("br",null,null,-1)),ge=d(()=>e("br",null,null,-1)),ye=d(()=>e("br",null,null,-1)),Ee={key:2,class:"card"},Ae={class:"card-header"},Se=d(()=>e("strong",null,"Edges in selected CAM:",-1)),Pe=["href"],Ie={class:"card-body"},Oe={class:"table table-bordered mb-2"},je=d(()=>e("thead",null,[e("tr",null,[e("th",null,"Subject"),e("th",null,"Edge"),e("th",null,"Object")])],-1)),Ne=d(()=>e("br",null,null,-1)),Ue=d(()=>e("br",null,null,-1)),Re=d(()=>e("em",null,"Description",-1)),ke=d(()=>e("br",null,null,-1)),$e=d(()=>e("em",null,"Information Content",-1)),Te=d(()=>e("br",null,null,-1)),Le=d(()=>e("em",null,"Equivalent identifiers",-1)),xe={key:0},Ke=d(()=>e("br",null,null,-1)),Ve=["href"],He=d(()=>e("br",null,null,-1)),De=d(()=>e("br",null,null,-1)),qe=d(()=>e("em",null,"Description",-1)),Be=d(()=>e("br",null,null,-1)),Fe=d(()=>e("em",null,"Information Content",-1)),we=d(()=>e("br",null,null,-1)),Ge=d(()=>e("em",null,"Equivalent identifiers",-1));function We(p,l,i,t,u,h){return n(),o(g,null,[t.downloadInProgress?(n(),o("div",ie,de)):I("",!0),t.downloadInProgress?I("",!0):(n(),o("div",re,[e("div",ue,[_e,r(),e("a",{target:"cam",href:i.selectedModel},a(i.selectedModel),9,pe)]),e("div",he,[e("div",me,[e("table",be,[e("thead",null,[e("tr",null,[fe,(n(!0),o(g,null,y(t.toIds,s=>(n(),o("th",Ce,[e("span",{title:t.descriptions[s]},a(s),9,ve),Me,r(a(t.labels[s]),1)]))),256))])]),e("tbody",null,[(n(!0),o(g,null,y(t.fromIds,s=>(n(),o("tr",null,[e("td",null,[e("strong",null,a(s),1),r(" "+a(t.labels[s]),1),ge,r(a(t.descriptions[s]),1)]),(n(!0),o(g,null,y(t.toIds,m=>(n(),o("td",null,[(n(!0),o(g,null,y(t.getPredicates(s,m),M=>(n(),o("span",null,[r(a(M),1),ye]))),256))]))),256))]))),256))])])])])])),t.downloadInProgress?I("",!0):(n(),o("div",Ee,[e("div",Ae,[Se,r(),e("a",{target:"cam",href:i.selectedModel},a(i.selectedModel),9,Pe)]),e("div",Ie,[e("table",Oe,[je,e("tbody",null,[(n(!0),o(g,null,y(t.modelRows,s=>(n(),o("tr",null,[e("td",null,[e("strong",null,a(s[0].id),1),r(" "+a(s[0].name),1),Ne,Ue,Re,r(": "+a(s[0].description),1),ke,$e,r(": "+a(s[0].information_content),1),Te,Le,r(": "+a(s[0].equivalent_identifiers),1)]),e("td",null,[e("strong",null,[r(a(s[3]),1),s[4]?(n(),o("span",xe," ["+a(s[4])+"]",1)):I("",!0)]),Ke,r(" biolink:primary_knowledge_source: "+a(s[1]["biolink:primary_knowledge_source"])+" ",1),e("ul",null,[(n(!0),o(g,null,y(s[1].xref,m=>(n(),o("li",{key:m},[e("a",{href:m,target:"xref"},a(m),9,Ve)]))),128))])]),e("td",null,[e("strong",null,a(s[2].id),1),r(" "+a(s[2].name),1),He,De,qe,r(": "+a(s[2].description),1),Be,Fe,r(": "+a(s[2].information_content),1),we,Ge,r(": "+a(s[2].equivalent_identifiers),1)])]))),256))])])])]))],64)}const Je=T(ae,[["render",We],["__scopeId","data-v-f17ac3eb"]]),Ye=$({__name:"SearchCAMs",props:{automatCAMKPEndpoint:{default:"https://automat.renci.org/cam-kp"},changeCAMList:{}},setup(p,{expose:l}){l();const i=p,t=C([]),u=C(""),h=C(""),s=C(""),m=C(""),M=C(10),O=C([]),j=C(!1);async function U(){j.value=!0,O.value=[];try{const b=await N(u.value.split(/\s*,\s*/).filter(c=>c),h.value.split(/\s*,\s*/).filter(c=>c),m.value.split(/\s*,\s*/).filter(c=>c),s.value.split(/\s*,\s*/).filter(c=>c),M.value);console.log(`Got ${b.length} CAM models: `,b),t.value=b,i.changeCAMList(b)}catch(b){O.value=b.message.split(`
`)}j.value=!1}async function N(b=[],c=[],f=[],E=[],A=100){const R=[],L=[];if(b.length>0&&(c.length>0||E.length>0))throw new Error(`searchModels() cannot be called with both subjectOrObjectCURIEs (${b.length}) and either subjectCURIEs (${c.length}) or objectCURIEs (${E.length}).`);c&&R.push(...c.map(_=>`'${_}' IN s.equivalent_identifiers`)),E&&L.push(...E.map(_=>`'${_}' IN o.equivalent_identifiers`)),b&&R.push(...b.map(_=>`'${_}' IN s.equivalent_identifiers OR '${_}' IN o.equivalent_identifiers`));const x=[];f&&x.push(...f.map(_=>`TYPE(p) = '${_}'`));const k=[];R.length>0&&k.push(R.map(_=>`(${_})`).join(" OR ")),L.length>0&&k.push(L.map(_=>`(${_})`).join(" OR ")),x.length>0&&k.push(x.map(_=>`(${_})`).join(" OR "));const D=k.join(" AND ");let K=`MATCH (s)-[p]-(o) RETURN DISTINCT p.xref LIMIT ${A}`;D.length>0&&(K=`MATCH (s)-[p]-(o) WHERE ${D} RETURN DISTINCT p.xref LIMIT ${A}`),console.log("Querying Cypher:",K);const w=i.automatCAMKPEndpoint+"/cypher";let V=await(await fetch(w,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:K})})).json();if(V.errors.length>0)throw Error(V.errors.map(_=>_.message).join(`
`));const q=V.results[0].data.flatMap(_=>_.row[0][0]);return console.log("rows",q),q}const v={props:i,results:t,subjectOrObjectCURIEsCSV:u,subjectCURIEsCSV:h,objectCURIEsCSV:s,predicateCURIEsCSV:m,limit:M,errors:O,inProgress:j,updateModelList:U,searchModels:N};return Object.defineProperty(v,"__isScriptSetup",{enumerable:!1,value:!0}),v}}),ze={class:"card my-2"},Qe=e("div",{class:"card-header"},[e("strong",null,"Search CAM models")],-1),Xe={class:"card-body"},Ze={key:0,class:"mb-3 p-1 border-1 bg-danger-subtle"},et={class:"mb-3"},tt=e("label",{for:"predicateCURIEs",class:"form-label"},"Predicate CURIEs",-1),st={class:"mb-3"},nt=e("label",{for:"subjectOrObjectCURIEs",class:"form-label"},"Subject or Object CURIEs",-1),ot={class:"mb-3"},lt=e("label",{for:"subjectCURIEs",class:"form-label"},"Subject CURIEs",-1),at={class:"mb-3"},it=e("label",{for:"objectCURIEs",class:"form-label"},"Object CURIEs",-1),ct={class:"mb-3"},dt=e("label",{for:"limit",class:"form-label"},"Limit",-1),rt=e("em",null,"Search in progress",-1),ut=[rt],_t={class:"card my-2"},pt={class:"card-header"},ht={class:"card-body"},mt={class:"table table-bordered mb-2"},bt=e("thead",null,[e("tr",null,[e("th",null,"Model URL")])],-1);function ft(p,l,i,t,u,h){return n(),o("div",null,[e("div",ze,[Qe,e("div",Xe,[t.errors.length>0?(n(),o("div",Ze,[e("ul",null,[(n(!0),o(g,null,y(t.errors,s=>(n(),o("li",null,a(s),1))),256))])])):I("",!0),e("div",et,[tt,S(e("input",{type:"text",class:"form-control",id:"predicateCURIEs",placeholder:"biolink:affects, biolink:affected_by","onUpdate:modelValue":l[0]||(l[0]=s=>t.predicateCURIEsCSV=s)},null,512),[[P,t.predicateCURIEsCSV]])]),e("div",st,[nt,S(e("input",{type:"text",class:"form-control",id:"subjectOrObjectCURIEs",placeholder:"PUBCHEM.COMPOUND:5865, CHEBI:8382","onUpdate:modelValue":l[1]||(l[1]=s=>t.subjectOrObjectCURIEsCSV=s)},null,512),[[P,t.subjectOrObjectCURIEsCSV]])]),e("div",ot,[lt,S(e("input",{type:"text",class:"form-control",id:"subjectCURIEs",placeholder:"CHEMBL.COMPOUND:CHEMBL158, PUBCHEM.COMPOUND:5742832","onUpdate:modelValue":l[2]||(l[2]=s=>t.subjectCURIEsCSV=s)},null,512),[[P,t.subjectCURIEsCSV]])]),e("div",at,[it,S(e("input",{type:"text",class:"form-control",id:"objectCURIEs",placeholder:"CHEMBL.COMPOUND:CHEMBL158, PUBCHEM.COMPOUND:5742832","onUpdate:modelValue":l[3]||(l[3]=s=>t.objectCURIEsCSV=s)},null,512),[[P,t.objectCURIEsCSV]])]),e("div",ct,[dt,S(e("input",{type:"text",class:"form-control",id:"limit","onUpdate:modelValue":l[4]||(l[4]=s=>t.limit=s)},null,512),[[P,t.limit]])]),t.inProgress?(n(),o("a",{key:1,onClick:l[5]||(l[5]=s=>t.updateModelList()),class:"btn btn-primary"},ut)):(n(),o("a",{key:2,onClick:l[6]||(l[6]=s=>t.updateModelList()),class:"btn btn-primary"},"Search"))])]),e("div",_t,[e("div",pt,[e("strong",null,"List CAM models ("+a(t.results.length)+")",1)]),e("div",ht,[e("table",mt,[bt,e("tbody",null,[(n(!0),o(g,null,y(t.results,s=>(n(),o("tr",null,[e("td",null,a(s),1)]))),256))])])])])])}const Ct=T(Ye,[["render",ft]]),vt=$({__name:"CAMKPFrontend",setup(p,{expose:l}){l();const i=C("https://automat.renci.org/cam-kp"),t=C([]),u=C("");function h(M){u.value=M}function s(M){t.value=M}const m={automatCAMKPEndpoint:i,camList:t,selectedModel:u,changeSelectedModel:h,changeCAMList:s,ListCAMs:le,DisplayCAM:Je,SearchCAMs:Ct};return Object.defineProperty(m,"__isScriptSetup",{enumerable:!1,value:!0}),m}}),Mt=Y('<div class="card my-2"><div class="card-header"><strong>CAM-KP Frontend</strong></div><div class="card-body"><p class="card-text"> The CAM-KP Frontend is intended to provide a frontend to the <a href="https://github.com/NCATSTranslator/Translator-All/wiki/CAM-Provider-KG">Causal Activity Models (CAM) Knowledge Graph (KG)</a>, as implemented in <a href="https://automat.renci.org/#/cam-kp">Automat CAM-KP</a>. </p><p class="card-text"><strong>Experimental and under development.</strong> Please report any issues to <a href="https://github.com/ExposuresProvider/cam-pipeline/issues">our GitHub repository</a>. </p></div></div>',1),gt={class:"accordion",id:"advancedOptionsAccordion"},yt={class:"accordion-item"},Et=e("h2",{class:"accordion-header",id:"advancedOptionsHeader"},[e("button",{class:"accordion-button collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#advancedOptions","aria-expanded":"false","aria-controls":"advancedOptions"}," Advanced options ")],-1),At={id:"advancedOptions",class:"accordion-collapse collapse","aria-labelledby":"advancedOptionsHeader","data-bs-parent":"#advancedOptionsAccordion"},St={class:"accordion-body"},Pt={class:"mb-3"},It=e("label",{for:"automatCAMKPEndpoint",class:"form-label"},"Automat CAM-KP Endpoint",-1);function Ot(p,l,i,t,u,h){return n(),o("main",null,[Mt,H(t.SearchCAMs,{automatCAMKPEndpoint:t.automatCAMKPEndpoint,changeCAMList:t.changeCAMList},null,8,["automatCAMKPEndpoint"]),H(t.ListCAMs,{automatCAMKPEndpoint:t.automatCAMKPEndpoint,camList:t.camList,changeSelectedModel:t.changeSelectedModel},null,8,["automatCAMKPEndpoint","camList"]),H(t.DisplayCAM,{"selected-model":t.selectedModel},null,8,["selected-model"]),e("div",gt,[e("div",yt,[Et,e("div",At,[e("div",St,[e("form",null,[e("div",Pt,[It,S(e("input",{type:"email",class:"form-control",id:"automatCAMKPEndpoint","aria-describedby":"emailHelp","onUpdate:modelValue":l[0]||(l[0]=s=>t.automatCAMKPEndpoint=s)},null,512),[[P,t.automatCAMKPEndpoint]])])])])])])])])}const Ut=T(vt,[["render",Ot]]);export{Ut as default};
